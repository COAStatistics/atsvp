version: '3.4'

volumes:
  static-volume:
  letsencrypt:

services:
  fds: &fds
    container_name: fds
    image: fds
    build: 
      context: .
    volumes:
      - ./FDS:/app
      - static-volume:/app/static_files
    command: /app/scripts/start.sh
    restart: on-failure
    env_file: ./FDS/.env
    networks:
      - atri
  
  nginx-certbot:
    restart: unless-stopped
    image: staticfloat/nginx-certbot
    ports:
      - 8080:80/tcp
      - 8443:443/tcp
    environment:
      CERTBOT_EMAIL: stat.coa@gmail.com
    volumes:
      - static-volume:/app/static_files
      - ./FDS/config/nginx:/etc/nginx/user.conf.d:ro
      - letsencrypt:/etc/letsencrypt
    networks:
      - atri
 

networks:
  atri:
    driver: bridge
